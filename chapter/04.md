# Chapter 4 - Views

## Overview

* Skill 10 - View Inheritance
* Skill 11 - Templates
* Skill 12 - Variables
* [Project 4 - Superhero Profiles](../project/4)


## Skill 10 - View Inheritance

### Review

* Skills 
    * 7 - Create a Django App
    * 8 - Create Template View
    * 9 - Add Variables to View 
* Projects
    * Setup development tools
    * Web Hosting at Digital Ocean
    * Create basic Django app

### Expand from the Basics

* Work incrementally
* Development workflow
    * Pull
    * Change/Test loop
    * Commit/Deploy changes
    * Test remotely


### Applications = Views + Data + Tests

Views present content  (Chapter 4)

* Defines all of the view logic as a Python object class
* Override any behavior you wish
* TemplateView shows an HTML template as a view
* Design patterns for custom Django views
* URL Routes Map the request to the Python code for the View

Data stores content  (Chapter 5)

* Allows database operations to be written in Python
* Python Classes modify the database structure
* Migrate the database tables after changing Models

Tests guarantee that everything works  (Chapter 6)

* Setup Django tests to check key items in your app
* Run Django tests regularly (at least once a day)
* Build tests as you write code


### Beyond Simple Views

You know the basics

Build large and complex pages

Problem with Duplicated code

Need to add skills to be productive

* Skill 10 - View Inheritance
* Skill 11 - Templates
* Skill 12 - Variables


## Skill 10 - View Inheritance

### View Inheritance Eliminates duplication

Define a base page template

Extend the base page to inherit the content

Example of View Inheritance


### Theme (base page)

Define a template that can be loaded like any other.  Notice the "{% block content %}".

    <!DOCTYPE html>
    <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Photo Builder</title>
            <link rel="stylesheet" href="styles.css">
        </head>
        
        <body>
            {% block content %}
                <h2>No Main Block Defined</h2>
            {% endblock content %}
        </body>
    </html>


### Photo Pages

The template can be extended to replace the "{% block content %}".

templates/photo_list.html

    {% extends 'photo_theme.html' %}
    
    {% block content %}

        <h1>List of Photos</h1>
        <ul>
          {% for photo in photos %}
            <li>{{ photo.title }}</li>
          {% endfor %}
        </ul>
        
    {% endblock content %}


templates/photo_detail.html

    {% extends 'photo_theme.html' %}
    
    {% block content %}

        <h1>Photo Details</h1>
        <p>{{ photo.file }}</p>
        <p>{{ photo.caption }}</p>
        <p><img src="{{ photo.file }}"></p>
        
    {% endblock content %}

    
### Views and URLs

photo/views.py

    from pathlib import Path
    from django.views.generic import TemplateView

    class PhotoListView(TemplateView):
        template_name = 'photos.html'

        def get_context_data(self, **kwargs):
            return dict(photos=photo_list())


    class PhotoDetailView(TemplateView):
        template_name = 'photo.html'

        def get_context_data(self, **kwargs):
            i = kwargs['id']
            photos = photo_list()
            return dict(photo=photos[i])


config/urls.py

    from django.urls import path
    from photo.views import PhotoDetailView, PhotoListView

    urlpatterns = [
        path('',         PhotoListView.as_view()),
        path('<int:pk>', PhotoDetailView.as_view()),
    ]


## Build a Good Theme

* Build a brand and should control the appearance
* The theme loads both CSS and JavaScript
* A header, footer, menus, and main are defined
* Consolidate visual appearance
* Use blocks to define replaceable content



## Skill 11 - Templates

### HTML Templates
* Templates can be defined to hold all the HTML content
* The Template Loader must be defined in settings.py
* Templates can be in several directories

### Global or App?

Templates can be located at the top of the application directory structure
or in each app that is defined.  Consider this example file listing.

    .
    ├── book
    │   ├── models.py
    │   ├── templates
    │   │   ├── book.html
    │   │   └── index.html
    │   └── views.py
    ├── config
    │   ├── settings.py
    ├── manage.py
    ├── pages
    │   ├── models.py
    │   ├── templates
    │   │   └── pages.html
    │   └── views.py
    ├── photos
    │   ├── models.py
    │   └── views.py
    └── templates
        ├── book.html
        ├── index.html
        ├── pages.html
        ├── photo.html
        └── photos.html


Note that the "pages.html" template appears in two places.  A template loader
within Django is configured in settings.  This will search the path in order
until it finds the desired template.  In this case the "pages/templates" directory
contains the desired template.

config/settings.py

    TEMPLATES = [
        {
            ...
            'DIRS': [
                        BASE_DIR / 'book' / 'templates',
                        BASE_DIR / 'pages' / 'templates',
                        BASE_DIR / 'photos' / 'templates',
                        BASE_DIR / 'templates',
                    ],
            ...
        },
    ]





### templates
* define HTML for pages
* template loader to lookup templates


### views.py
* logic to convert a request into a response
* written in Python
* calls hidden logic that does a lot of work


### urls.py
* listens for specific requests
* define URL routes to pages
* maps the request onto a view


## Skill 12 - Complex Variables in Views

### Where does the logic go?
* URLs
* Views
* Templates
* Data


### [Project 4 - Superhero Profiles](../project/4)






### Django Does all of the Hard Work
* Batteries Included
* At least 1000 years of software development
* Opinionated 


### Setup workflow
* new terminal window
* activate virtual environment
* edit window
* browser


